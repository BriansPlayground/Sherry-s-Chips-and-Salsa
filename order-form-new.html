<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Now - Sherry's Eats</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .order-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
        }

        .step {
            display: flex;
            align-items: center;
            margin: 0 20px;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .step.active .step-number {
            background: #28a745;
            color: white;
        }

        .step.completed .step-number {
            background: #6c757d;
            color: white;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .product-card {
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            border-color: #28a745;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .product-card.selected {
            border-color: #28a745;
            background: #f8fff9;
        }

        .product-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .product-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .product-description {
            color: #666;
            margin-bottom: 15px;
        }

        .size-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .size-option {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .size-option:hover {
            background: #f8f9fa;
        }

        .size-option.selected {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: #28a745;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: #218838;
            transform: scale(1.1);
        }

        .quantity-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .quantity-display {
            font-size: 1.5rem;
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .delivery-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #28a745;
        }

        .running-total {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .running-total.zero {
            background: #6c757d;
        }

        .btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .hidden {
            display: none;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .summary-item:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .order-card {
                padding: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .running-total {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
                display: inline-block;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå∂Ô∏è Sherry's Eats</h1>
            <p>Fresh, homemade chips and salsa delivered to your door</p>
        </div>

        <div class="running-total" id="running-total">
            Total: $0.00
        </div>

        <!-- Step 1: Products -->
        <div class="order-card" id="step1">
            <div class="step-indicator">
                <div class="step active">
                    <div class="step-number">1</div>
                    <span>Choose Products</span>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <span>Delivery Info</span>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <span>Complete Order</span>
                </div>
            </div>

            <h2 class="section-title">What would you like?</h2>
            <div class="product-grid" id="product-grid">
                <!-- Products will be loaded here -->
            </div>

            <div class="navigation">
                <div></div>
                <button class="btn" id="next-btn-1" onclick="nextStep()" disabled>Next Step</button>
            </div>
        </div>

        <!-- Step 2: Delivery -->
        <div class="order-card hidden" id="step2">
            <div class="step-indicator">
                <div class="step completed">
                    <div class="step-number">‚úì</div>
                    <span>Choose Products</span>
                </div>
                <div class="step active">
                    <div class="step-number">2</div>
                    <span>Delivery Info</span>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <span>Complete Order</span>
                </div>
            </div>

            <h2 class="section-title">Where should we deliver?</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="city">Delivery City</label>
                    <select id="city" required>
                        <option value="">Choose your city...</option>
                        <option value="Metamora">Metamora</option>
                        <option value="Davison">Davison</option>
                        <option value="Lapeer">Lapeer</option>
                        <option value="Imlay City">Imlay City</option>
                        <option value="Capac">Capac</option>
                        <option value="Armada">Armada</option>
                        <option value="Waterford">Waterford</option>
                        <option value="Clarkston">Clarkston</option>
                        <option value="Oxford">Oxford</option>
                        <option value="Lake Orion">Lake Orion</option>
                        <option value="Auburn Hills">Auburn Hills</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">Delivery Date</label>
                    <input type="date" id="date" required>
                </div>
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                <button class="btn" id="next-btn-2" onclick="nextStep()" disabled>Next Step</button>
            </div>
        </div>

        <!-- Step 3: Customer Info -->
        <div class="order-card hidden" id="step3">
            <div class="step-indicator">
                <div class="step completed">
                    <div class="step-number">‚úì</div>
                    <span>Choose Products</span>
                </div>
                <div class="step completed">
                    <div class="step-number">‚úì</div>
                    <span>Delivery Info</span>
                </div>
                <div class="step active">
                    <div class="step-number">3</div>
                    <span>Complete Order</span>
                </div>
            </div>

            <h2 class="section-title">Almost done!</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="name">Your Name</label>
                    <input type="text" id="name" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" required>
                </div>
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" required>
            </div>

            <div class="form-group">
                <label for="address">Delivery Address</label>
                <input type="text" id="address" required placeholder="Street address, city, zip">
            </div>

            <div class="form-group">
                <label for="notes">Special Instructions (Optional)</label>
                <input type="text" id="notes" placeholder="Any special delivery instructions...">
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                <button class="btn" id="submit-btn" onclick="submitOrder()">Place Order</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedProducts = [];

        const products = [
            {
                id: 1,
                name: 'Mild Salsa',
                description: 'Perfect for everyone',
                icon: 'üå∂Ô∏è',
                sizes: [
                    { size: '16oz', price: 8.00 },
                    { size: '32oz', price: 15.00 }
                ]
            },
            {
                id: 2,
                name: 'Enjoyable Salsa',
                description: 'A little more heat',
                icon: 'üî•',
                sizes: [
                    { size: '16oz', price: 8.00 },
                    { size: '32oz', price: 15.00 }
                ]
            },
            {
                id: 3,
                name: 'Burn Your Ass Hot',
                description: 'For heat lovers',
                icon: 'üå∂Ô∏è‚Äçüî•',
                sizes: [
                    { size: '16oz', price: 8.00 },
                    { size: '32oz', price: 15.00 }
                ]
            },
            {
                id: 4,
                name: 'Inferno Salsa',
                description: 'Extreme heat',
                icon: 'üî•',
                sizes: [
                    { size: '16oz', price: 8.00 },
                    { size: '32oz', price: 15.00 }
                ]
            },
            {
                id: 5,
                name: 'Fresh Chips',
                description: 'Made daily',
                icon: 'ü•î',
                sizes: [
                    { size: '1lb bag', price: 8.00 }
                ]
            },
            {
                id: 6,
                name: 'Salsa Platter',
                description: '8oz of each flavor + 1lb chips',
                icon: 'üçΩÔ∏è',
                sizes: [
                    { size: 'Complete Platter', price: 30.00 }
                ]
            }
        ];

        function init() {
            loadProducts();
            setMinDate();
            updateRunningTotal();
        }

        function loadProducts() {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.id = `product-${product.id}`;
                
                const sizeOptions = product.sizes.map((size, index) => 
                    `<div class="size-option" onclick="selectSize(${product.id}, ${index})" data-product="${product.id}" data-size="${index}">${size.size}</div>`
                ).join('');

                productCard.innerHTML = `
                    <div class="product-icon">${product.icon}</div>
                    <div class="product-title">${product.name}</div>
                    <div class="product-description">${product.description}</div>
                    <div class="size-options">${sizeOptions}</div>
                    <div class="quantity-controls">
                        <button class="quantity-btn" onclick="changeQuantity(${product.id}, -1)" disabled>-</button>
                        <div class="quantity-display" id="qty-${product.id}">0</div>
                        <button class="quantity-btn" onclick="changeQuantity(${product.id}, 1)">+</button>
                    </div>
                `;

                grid.appendChild(productCard);
            });
        }

        function selectSize(productId, sizeIndex) {
            // Remove selection from all sizes of this product
            document.querySelectorAll(`[data-product="${productId}"]`).forEach(el => {
                el.classList.remove('selected');
            });
            
            // Select the clicked size
            document.querySelector(`[data-product="${productId}"][data-size="${sizeIndex}"]`).classList.add('selected');
            
            // Update product card selection
            document.getElementById(`product-${productId}`).classList.add('selected');
            
            // Initialize product in selectedProducts if not exists
            if (!selectedProducts.find(p => p.id === productId)) {
                selectedProducts.push({
                    id: productId,
                    sizeIndex: sizeIndex,
                    quantity: 0
                });
            } else {
                selectedProducts.find(p => p.id === productId).sizeIndex = sizeIndex;
            }
            
            updateRunningTotal();
        }

        function changeQuantity(productId, change) {
            const product = selectedProducts.find(p => p.id === productId);
            if (!product) return;

            const newQuantity = Math.max(0, product.quantity + change);
            product.quantity = newQuantity;

            document.getElementById(`qty-${productId}`).textContent = newQuantity;
            
            // Enable/disable buttons
            const buttons = document.querySelectorAll(`[onclick="changeQuantity(${productId}, -1)"], [onclick="changeQuantity(${productId}, 1)"]`);
            buttons[0].disabled = newQuantity === 0;
            
            updateRunningTotal();
            updateNextButton();
        }

        function updateRunningTotal() {
            const total = selectedProducts.reduce((sum, product) => {
                const productData = products.find(p => p.id === product.id);
                if (!productData || product.sizeIndex === undefined) return sum;
                
                const price = productData.sizes[product.sizeIndex].price;
                return sum + (price * product.quantity);
            }, 0);

            const totalElement = document.getElementById('running-total');
            totalElement.textContent = `Total: $${total.toFixed(2)}`;
            
            if (total === 0) {
                totalElement.classList.add('zero');
            } else {
                totalElement.classList.remove('zero');
            }
        }

        function updateNextButton() {
            const hasProducts = selectedProducts.some(p => p.quantity > 0);
            document.getElementById('next-btn-1').disabled = !hasProducts;
        }

        function setMinDate() {
            const dateInput = document.getElementById('date');
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            dateInput.min = tomorrow.toISOString().split('T')[0];
        }

        function nextStep() {
            if (currentStep === 1) {
                // Validate products selected
                const hasProducts = selectedProducts.some(p => p.quantity > 0);
                if (!hasProducts) {
                    alert('Please select at least one product!');
                    return;
                }
            } else if (currentStep === 2) {
                // Validate delivery info
                const city = document.getElementById('city').value;
                const date = document.getElementById('date').value;
                
                if (!city || !date) {
                    alert('Please fill in all delivery information!');
                    return;
                }
            }

            // Hide current step
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            
            // Show next step
            currentStep++;
            document.getElementById(`step${currentStep}`).classList.remove('hidden');
            
            // Update step indicators
            updateStepIndicators();
        }

        function prevStep() {
            // Hide current step
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            
            // Show previous step
            currentStep--;
            document.getElementById(`step${currentStep}`).classList.remove('hidden');
            
            // Update step indicators
            updateStepIndicators();
        }

        function updateStepIndicators() {
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else if (index + 1 < currentStep) {
                    step.classList.add('completed');
                }
            });
        }

        function submitOrder() {
            // Validate form
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const address = document.getElementById('address').value;
            
            if (!name || !phone || !email || !address) {
                alert('Please fill in all required fields!');
                return;
            }

            // Collect order data
            const orderData = {
                products: selectedProducts.filter(p => p.quantity > 0).map(product => {
                    const productData = products.find(p => p.id === product.id);
                    const size = productData.sizes[product.sizeIndex];
                    return {
                        name: productData.name,
                        size: size.size,
                        quantity: product.quantity,
                        price: size.price
                    };
                }),
                delivery: {
                    city: document.getElementById('city').value,
                    date: document.getElementById('date').value,
                    address: address
                },
                customer: {
                    name: name,
                    phone: phone,
                    email: email,
                    notes: document.getElementById('notes').value
                }
            };

            // Submit order
            fetch('/api/orders', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(orderData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(`Order placed successfully! Order #${data.order_id}\n\nWe'll contact you to confirm delivery details.`);
                    // Reset form or redirect
                    window.location.href = 'index.html';
                } else {
                    alert('Error placing order: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error placing order. Please try again or call us at (810) 627-8204');
            });
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
